---
title: "Acumen_test"
author: "Jieqi Tu, jt3098"
date: "2/25/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r Import data}
data = readxl::read_excel("./Acumen_Data_Analysis_Exercise.xlsx", sheet = "Data") %>% janitor::clean_names()
data$employee_id = as.factor(data$employee_id)
data$quarter = as.factor(data$quarter)
```

## Question 1

#### (a)
```{r observations}
# Is there any outliers?
data %>% 
  ggplot(aes(x = quarter, y = health_score)) + geom_boxplot() + theme_bw()
```

```{r missing values}
# Calculate missing values
n_NA = sapply(data[1:9], function(x) sum(length(which(is.na(x)))))
n_NA %>% knitr::kable()
```

#### (b)
```{r characteristics}
# Gender distribution
data %>% 
  group_by(sex_male_1) %>% 
  summarise(n = length(employee_id))

# Race distribution
data %>% 
  group_by(race) %>% 
  summarise(n = length(employee_id))

# Filter out unreasonable health scores
data_new = 
  data %>% 
  filter(health_score != "10")
data_new$race = as.factor(data_new$race)

# Boxplot
ggplot(data = data_new, aes(x = as.factor(quarter), y = health_score, color = race)) + geom_boxplot() +
  labs(
    x = "Quarter",
    y = "Race"
  ) + theme_bw()

ggplot(data = data_new, aes(x = as.factor(quarter), y = health_score, color = sex_male_1)) + geom_boxplot() +
  labs(
    x = "Quarter",
    y = "Health Score"
  ) + theme_bw()
```

